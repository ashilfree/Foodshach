{% extends 'base.html.twig' %}
{% block body %}

    <!-- start hero -->
    <div id="hero" class="jarallax" data-speed="0.7" data-img-position="50% 100%" style="background-image: url({{ '/media/images/intro_img/13.jpg' }});color: #333;">
        <div class="container">
            <div class="row">
                <div class="col-12 col-md-12">
                    <h2 class="__title"><span>Food Shack Company</span>Billing Details</h2>


                </div>
            </div>
        </div>
    </div>
    <!-- end hero -->

    <!-- start main -->
    <main role="main">
        <div class="container mt-60 py-30 mb-60">
            <div class="row">
                <div class="col-12">

                    <!-- start checkout -->
                    <div class="checkout">
                        <h2>BILLING <span>DETAILS</span></h2>

                        <div class="spacer py-3"></div>
                        {{ form_start(form, {'attr': {'class': 'checkout__form js-checkout-form', 'onsubmit': 'setFormSubmitting()'}}) }}
                            <div class="row justify-content-xl-between">
                                <div class="col-12 col-md-5 col-lg-6">
                                    <div><h6>Personal Information</h6></div>
                                    <div class="my-custom-class-for-errors">

                                    </div>
                                    <div class="row">
                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingFirstName, {'attr': {'class': 'textfield', 'placeholder':'First name *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingLastName, {'attr': {'class': 'textfield', 'placeholder':'Last name *'}}) }}
                                            </div>
                                        </div>


                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingPhone, {'attr': {'class': 'textfield', 'placeholder':'Phone *'}}) }}
                                            </div>
                                            <small style="color:red;">{{ form_errors(form.shippingPhone) }}</small>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingEmail, {'attr': {'class': 'textfield', 'placeholder':'Email address *'}}) }}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="spacer py-6"></div>

                                    <div><h6>Address</h6></div>

                                    <div class="row">
                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingCountry, {'id': 'country', 'attr': {'class': 'textfield wide js-select'}}) }}
{#                                                <select class="textfield wide js-select">#}
{#                                                    <option>Country * 1</option>#}
{#                                                    <option>Country * 2</option>#}
{#                                                    <option>Country * 3</option>#}
{#                                                    <option>Country * 4</option>#}
{#                                                    <option>Country * 5</option>#}
{#                                                </select>#}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingCity, {'id': 'city', 'attr': {'class': 'textfield', 'placeholder':'Governorate *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingProvince, {'id': 'province', 'attr': {'class': 'textfield', 'placeholder':'Region *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingPostalCode, {'id': 'postalCode', 'attr': {'class': 'textfield', 'placeholder':'Bloc Number *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingStreetNumber, {'id': 'province', 'attr': {'class': 'textfield', 'placeholder':'Street Number *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingHouseNumber, {'id': 'postalCode', 'attr': {'class': 'textfield', 'placeholder':'House Number *'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="input-wrp">
                                                {{ form_widget(form.shippingApartment, {'id': 'address', 'attr': {'class': 'textfield text-left', 'placeholder':'Apartment'}}) }}
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="input-wrp">
                                                {{ form_widget(form.notes, {'id': 'notes', 'attr': {'class': 'textfield', 'placeholder':'Order notes (optional)'}}) }}
                                            </div>
                                        </div>
                                    </div>

                                    <a href="{{ path('back.to.cart', { locale: 'en' }) }}" class="custom-btn custom-btn--medium custom-btn--style-1" style="margin-top: 55px" role="button" id="back">Back to Cart</a>

                                    <div class="spacer py-6 d-md-none"></div>
                                </div>

                                <div class="col-12 col-md-7 col-lg-6 col-xl-5">
                                    <div><h6>Your products</h6></div>

                                    <div class="checkout__table">
                                        <table>
                                            <tbody>
                                            {% set total = null %}
                                            {% for productCart in cart2order %}
                                                <tr>
                                                    <td width="65%">
                                                        <div class="d-table">
                                                            <div class="d-table-cell align-middle">
                                                                <figure class="__image">
                                                                    <a href="#">
                                                                        <img class="lazy" src="{{ vich_uploader_asset(productCart.product.images.first, 'imageFile') | imagine_filter('small') }}" data-src="{{ vich_uploader_asset(productCart.product.images.first, 'imageFile') | imagine_filter('small') }}" alt="demo" />
                                                                    </a>
                                                                </figure>
                                                            </div>

                                                            <div class="d-table-cell align-middle">
                                                                <a href="#" class="__name">{{ productCart.product.name }}</a>
                                                            </div>
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <span class="__amount">x{{ productCart.quantity }}</span>
                                                    </td>

                                                    <td width="1%">
                                                        <span class="__total">
                                                            {% if productCart.product.discountPrice != 0.0 %}
                                                                <span> {{ (productCart.product.discountPrice * productCart.quantity  / 100) |number_format(3, '.', ',') }}</span> {{ currency }}
                                                            {% else %}
                                                                <span>{{ (productCart.product.price * productCart.quantity  / 100) |number_format(3, '.', ',') }}</span> {{ currency }}
                                                            {% endif %}
                                                        </span>
                                                    </td>
                                                </tr>
                                                {% if productCart.product.discountPrice != 0.0 %}
                                                    {% set total = total + (productCart.quantity * productCart.product.discountPrice)/100 %}
                                                {% else %}
                                                    {% set total = total + (productCart.quantity * productCart.product.price)/100 %}
                                                {% endif %}
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>

                                    <div class="checkout__total">
                                        <table>
                                            <thead>
                                            <tr>
                                                <td colspan="2"><h3>YOUR <span>ORDER</span></h3></td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td>Subtotal:</td>
                                                <td>{{ total|number_format(3, '.', ',') }} {{ currency }}</td>
                                            </tr>

                                            <tr>
                                                <td>Shipping</td>
                                                <td>{{ (delivery2order/100)|number_format(3, '.', ',') }} {{ currency }}</td>
                                            </tr>

                                            <tr>
                                                <td>Total</td>
                                                <td>{{ (total+ delivery2order/100)|number_format(3, '.', ',') }} {{ currency }}</td>
                                            </tr>
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td colspan="2" class="__note">
                                                    <p class="__ttl">Payment Method</p>
                                                    <div class="row">
                                                        <div class="col-12 col-sm-6 col-md-12 col-lg-6">
                                                            <div class="input-wrp">
                                                                {{ form_widget(form.paymentMethod, {'id': 'paymentMethod', 'attr': {'class': 'textfield wide js-select'}}) }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>

                                            <tr>
                                                <td colspan="2">
{#                                                    <p>Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our privacy policy.</p>#}

                                                    <button class="custom-btn custom-btn--medium custom-btn--style-1" type="submit" role="button">Place Order</button>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            {{ form_end(form) }}
                    </div>
                    <!-- end checkout -->

                </div>
            </div>
        </div>




    </main>
    <!-- end main -->

{% endblock %}

{% block javascripts %}
    <script>
        var formSubmitting = false;
        var setFormSubmitting = function() { formSubmitting = true; };

        window.onbeforeunload = function(){
            if (formSubmitting) {
                return undefined;
            }
            return 'Are you sure you want to leave this page?';
        };
        // window.onload = function() {
        //    window.addEventListener("beforeunload", function (e) {
        //         if (formSubmitting) {
        //             return undefined;
        //         }
        //
        //         var confirmationMessage = 'It looks like you have been editing something. '
        //             + 'If you leave before saving, your changes will be lost.';
        //
        //         (e || window.event).returnValue = confirmationMessage;
        //         return confirmationMessage; //Gecko + Webkit, Safari, Chrome etc.
        //     });
        // };
    </script>
{% endblock %}
